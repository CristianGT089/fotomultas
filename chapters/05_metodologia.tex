\section{Metodología}

La realización de este proyecto se estructuró bajo un enfoque metodológico dual, diseñado para abordar tanto los requerimientos de una investigación aplicada como las particularidades del desarrollo de una solución tecnológica innovadora. A continuación se describen: el enfoque metodológico de investigación, la selección y justificación de la pila tecnológica, y el modelo de desarrollo de software utilizado para construir el prototipo.

\subsection{Enfoque metodológico de investigación}

Este trabajo se enmarca en una investigación aplicada, orientada a resolver un problema práctico y concreto: las deficiencias de integridad, transparencia y confianza en el sistema actual de gestión de fotocomparendos en Bogotá. Además, adopta un enfoque descriptivo, ya que se detallan las características, arquitectura y funcionamiento de un sistema descentralizado basado en blockchain e IPFS, estableciendo un caso de estudio sobre la aplicación de estas tecnologías en el sector público.

\subsection{Selección y justificación de la pila tecnológica}

Una fase crítica fue la selección de las tecnologías de registro distribuido (DLT) que servirían como pilar del sistema. La decisión impacta directamente en:

\begin{itemize}
    \item Privacidad de datos personales (Ley 1581 de 2012).
    \item Escalabilidad ante $\sim$457.000 comparendos semestrales.
    \item Costos operativos predecibles (sin criptomonedas volátiles).
    \item Modelo de gobernanza institucional.
\end{itemize}

\subsubsection{¿Por qué blockchain y no otra tecnología de registro distribuido?}

Antes de seleccionar qué implementación específica de blockchain utilizar, es fundamental justificar por qué esta tecnología es la más apropiada frente a otras alternativas de registro distribuido. Para el caso de uso de fotocomparendos, donde la \textbf{integridad irrefutable} y la \textbf{verificación ciudadana independiente} son requisitos no negociables, blockchain emerge como la tecnología más apropiada.

La Tabla~\ref{tab:blockchain_vs_dlt} compara blockchain con otras tecnologías emergentes de registro distribuido.

\begin{table}[H]
\centering
\small
\caption{Comparación de blockchain con otras tecnologías de registro distribuido}
\label{tab:blockchain_vs_dlt}
\begin{tabular}{p{2.5cm}p{2.7cm}p{2.7cm}p{2.7cm}p{2.7cm}}
\toprule
\textbf{Criterio} & \textbf{Blockchain} & \textbf{Hashgraph} & \textbf{BD Distribuida} & \textbf{BD Centralizada} \\
\midrule
Inmutabilidad & Alta (criptográfica) & Media (consenso virtual) & Baja (config.) & Ninguna (admin.) \\
\midrule
Resistencia manipulación & Alta (prohibitiva) & Media & Baja (permisos) & Ninguna (admin) \\
\midrule
Auditabilidad & Alta (completa) & Media (parcial) & Baja (logs modificables) & Baja (logs centralizados) \\
\midrule
Descentralización & Alta (real) & Alta (real) & Baja (réplicas) & Ninguna \\
\midrule
Verificación indep. & Alta (sin confianza) & Media (requiere nodos) & Ninguna (acceso BD) & Ninguna (API controlada) \\
\midrule
Estándares & Alta (maduros) & Baja (emergente) & Media (SQL/NoSQL) & Alta (SQL) \\
\midrule
Rendimiento (TPS) & Media (15-20.000) & Alta (>10.000) & Alta (>100.000) & Alta (>100.000) \\
\midrule
Costo operativo & Alto & Moderado & Moderado & Bajo \\
\midrule
Precedente legal & Alto (eIDAS UE) & Bajo (sin precedente) & Medio (aceptado) & Alto (estándar) \\
\midrule
\textbf{Apto evidencia legal} & \textbf{SÍ} & Parcial & NO & NO \\
\bottomrule
\end{tabular}
\end{table}

\paragraph{Justificación de la elección de blockchain}

La selección de blockchain se fundamenta en los siguientes argumentos técnicos y legales:

\begin{enumerate}
    \item \textbf{Inmutabilidad criptográfica verificable:} A diferencia de bases de datos donde los logs pueden ser alterados por administradores con privilegios elevados, blockchain garantiza que modificar un registro requeriría alterar toda la cadena desde ese punto, lo cual es computacionalmente prohibitivo \parencite{nakamoto2008bitcoin}. Esta propiedad es crítica para evidencia que puede ser objeto de litigio.

    \item \textbf{Verificación sin confianza (trustless):} Un ciudadano puede verificar la autenticidad de un fotocomparendo sin necesidad de confiar en la institución emisora, simplemente validando la cadena de hashes. Esto no es posible con bases de datos tradicionales donde la verificación depende de APIs controladas por la misma entidad \parencite{antonopoulos2023mastering}. Esta característica aborda directamente la crisis de confianza reflejada en la tasa de impugnación del 34.1\%.

    \item \textbf{Precedente legal reconocido:} Existen marcos regulatorios emergentes que reconocen la validez legal de registros blockchain. El Reglamento eIDAS de la Unión Europea \parencite{europa_eidas} establece un marco para la identificación electrónica y servicios de confianza que incluye tecnologías de registro distribuido. Tecnologías más recientes como Hashgraph \parencite{baird2016swirlds} aún no han establecido precedentes legales comparables.

    \item \textbf{Auditabilidad completa e inmutable:} Cada transacción queda registrada con timestamp inmutable, creando una cadena de custodia digital irrefutable para procesos sancionatorios \parencite{swan2015blockchain}. Esta trazabilidad es esencial para cumplir con los requisitos de debido proceso administrativo.

    \item \textbf{Madurez del ecosistema:} Blockchain cuenta con implementaciones probadas en producción (Hyperledger Fabric \parencite{cachin2018architecture}, Ethereum \parencite{wood2014ethereum}), herramientas de desarrollo consolidadas y comunidades activas. Si bien tecnologías como Hashgraph ofrecen mayor rendimiento teórico \parencite{hedera_whitepaper}, o IOTA Tangle \parencite{popov2018tangle} promete eliminación de fees, ninguna ha demostrado la robustez operativa de blockchain en entornos gubernamentales críticos.
\end{enumerate}

Estudios comparativos recientes \parencite{ruan2019blockchainvsdb, karlsson2019permissioned} confirman que, si bien bases de datos distribuidas como Cassandra tienen menor costo operativo y mayor rendimiento bruto, ninguna proporciona el nivel de \textbf{confianza descentralizada} y \textbf{resistencia a manipulación} que requiere un sistema de sanciones gubernamentales donde la percepción de imparcialidad es crítica.

Con esta fundamentación establecida, la siguiente decisión crítica es determinar qué implementación específica de blockchain utilizar y cómo estructurar la arquitectura del sistema.

\paragraph{Arquitectura híbrida: balance entre privacidad y transparencia}

Dado que ninguna blockchain cumple simultáneamente con todos los requisitos (privacidad de datos sensibles + transparencia pública + rendimiento + costos controlados), se optó por una \textbf{arquitectura híbrida}:

\begin{itemize}
    \item \textbf{Capa privada (permisionada):} gestión interna y datos sensibles.
    \item \textbf{Capa pública (blockchain):} verificación ciudadana sin intermediarios.
\end{itemize}

\subsubsection{Capa privada: Hyperledger Fabric}

Para la capa privada se seleccionó Hyperledger Fabric tras un análisis comparativo de plataformas blockchain.

\begin{table}[H]
\centering
\small
\caption{Comparativo de plataformas blockchain para selección de arquitectura híbrida}
\label{tab:comparacion_blockchains}
\begin{tabular}{p{2.4cm}p{2.2cm}p{2cm}p{2cm}p{2cm}p{2cm}}
\toprule
\textbf{Criterio} & \textbf{Hyperledger Fabric} & \textbf{Ethereum} & \textbf{Corda} & \textbf{Solana} & \textbf{Polygon} \\
\midrule
Tipo de red & Permisionada & Pública & Permisionada & Pública & Pública \\
Consenso & Raft / BFT & PoS & Notario & PoH + PoS & PoS \\
TPS & 2.000–20.000 & $\sim$30 & $\sim$1.000 & 65.000+ & 7.000+ \\
Privacidad & Alta$^{(1)}$ & Nula & Alta (P2P) & Nula & Nula \\
Smart contracts & Go, Java, Node.js & Solidity & Kotlin/Java & Rust/C & Solidity \\
Control de acceso & PKI / Roles & Abierto & Identidad & Abierto & Abierto \\
Moneda nativa & No & ETH & No & SOL & MATIC \\
Costo / tx & Sin gas & Gas variable & Sin gas & Muy bajo & Muy bajo \\
Madurez Gob. & Alta & Media & Alta (banca) & Baja (DeFi) & Media \\
\bottomrule
\end{tabular}
\vspace{2pt}
\footnotesize
\label{tab:dlt_smart}
\end{table}

\textbf{Razones de elección de Hyperledger Fabric:}

\begin{itemize}
    \item \textbf{Privacidad y confidencialidad:} canales y colecciones privadas permiten segmentar la información, garantizando que solo entidades autorizadas (agentes, auditores) accedan a datos sensibles, cumpliendo la Ley 1581 de 2012.
    
    \item \textbf{Rendimiento:} 2 000–20 000 TPS, suficiente para el volumen de Bogotá sin cuellos de botella.
    
    \item \textbf{Sin costos de gas:} elimina volatilidad y complejidad, crítico para presupuestos gubernamentales.
    
    \item \textbf{Control de acceso granular:} PKI + roles definidos internamente (admin, agente, auditor, ciudadano).
\end{itemize}

\textbf{Descarte de alternativas:}
\begin{itemize}
    \item \textbf{Ethereum / Solana / Polygon:} públicas $\Rightarrow$ exposición total de datos y costos variables.
    \item \textbf{Corda:} orientada a finanzas; menor flexibilidad para evidencias fotográficas heterogéneas.
\end{itemize}

\subsubsection{Capa pública: Ethereum}

Para la verificación ciudadana se eligió Ethereum (testnet Sepolia) por:

\begin{itemize}
    \item \textbf{Máxima transparencia:} cualquier persona puede verificar metadatos sin permisos.
    
    \item \textbf{Ecosistema maduro:} mayor comunidad, herramientas (Ethers.js, Hardhat) y estándares (ERC-20, ERC-721).
    
    \item \textbf{Costo controlado:} solo se publican hashes y metadatos no sensibles, minimizando gastos de gas.
\end{itemize}

\subsection{Metodología de desarrollo de software: modelo por prototipos}

Para la construcción del sistema, se seleccionó el \textbf{Modelo de Desarrollo por Prototipos} (\textit{Prototyping Model}). Esta elección metodológica fue estratégica y se fundamenta en las características inherentes al proyecto.

\subsubsection{Justificación de la elección}

La adopción de este modelo iterativo responde a tres factores cruciales:

\begin{enumerate}
    \item \textbf{Naturaleza Innovadora y Riesgo Tecnológico:} El proyecto combina tecnologías emergentes como blockchain (Hyperledger Fabric y Ethereum) e IPFS en un dominio gubernamental donde no existían precedentes locales de una integración similar. La alta incertidumbre sobre el rendimiento, la seguridad de los contratos inteligentes y la viabilidad de la sincronización entre redes heterogéneas requería una validación temprana para mitigar riesgos técnicos fundamentales.
    
    \item \textbf{Requisitos Evolutivos:} Los requisitos funcionales y no funcionales de un sistema de esta naturaleza están sujetos a cambios, tanto por la evolución de la tecnología como por posibles ajustes en el marco normativo de las sanciones de tránsito. El enfoque por prototipos ofrece la flexibilidad necesaria para adaptar la solución de forma ágil a medida que se profundiza el entendimiento del problema.
    
    \item \textbf{Validación Temprana de Conceptos:} Era imperativo demostrar la hipótesis central del proyecto —que la combinación de blockchain e IPFS puede garantizar la inmutabilidad y verificabilidad de la evidencia digital— antes de invertir recursos en el desarrollo de una plataforma completa. El prototipo sirvió como una prueba de concepto funcional para validar esta premisa.
\end{enumerate}

\subsubsection{Fases del proceso de desarrollo}

El ciclo de vida del desarrollo siguió las fases iterativas del modelo de prototipos, adaptadas a los objetivos específicos del proyecto, como se describe en la Tabla~\ref{tab:fases_prototipos}.

\begin{longtable}{|p{3cm}|p{5cm}|p{6cm}|}
\label{tab:fases_prototipos} \\
\hline
\textbf{Fase} & \textbf{Descripción} & \textbf{Aplicación en el Proyecto} \\ \hline
\endfirsthead

\endhead

\endfoot

\hline
\endlastfoot

\textbf{1. Requisitos Iniciales} & Recopilación de los requisitos funcionales básicos y esenciales del sistema. & Se definieron las funcionalidades mínimas viables: registro inmutable de multas, almacenamiento de evidencia en IPFS, consulta pública y un mecanismo para la verificación de integridad. \\ \hline
\textbf{2. Construcción del Prototipo} & Desarrollo rápido de una versión funcional reducida que implementa los requisitos iniciales. & Se implementó un prototipo funcional que incluía un Smart Contract en una red local de Ethereum, una API REST para la comunicación y un frontend básico para la interacción del usuario. \\ \hline
\textbf{3. Evaluación del Prototipo} & Validación del prototipo mediante pruebas internas para evaluar su funcionalidad y alineación con los objetivos. & Se ejecutó un plan de pruebas exhaustivo (detallado en el Capítulo 9) para validar la inmutabilidad de los registros, la integridad de la evidencia y la usabilidad de la interfaz con datos simulados. \\ \hline
\textbf{4. Refinamiento e Iteración} & Ajuste y mejora del prototipo basándose en los hallazgos de la evaluación. & Con base en los resultados, se optimizó el consumo de gas del Smart Contract, se mejoraron las validaciones de la API y se refinó la arquitectura para incorporar la capa privada con Hyperledger Fabric. \\ \hline
\textbf{5. Documentación Final} & Una vez validado el concepto, se documenta la arquitectura final y se proponen los siguientes pasos. & Se consolidó el diseño de la arquitectura híbrida final y se elaboró un \textit{roadmap} detallado para una eventual implementación en un entorno de producción. \\ \hline
\end{longtable}

\subsubsection{Ventajas y limitaciones del enfoque}

La metodología por prototipos ofreció ventajas estratégicas determinantes para el éxito del proyecto, entre las que destacan la \textbf{validación temprana de la arquitectura híbrida}, la \textbf{mitigación de riesgos técnicos} relacionados con el rendimiento de IPFS y la \textbf{reducción de costos} al permitir ajustes antes de la fase final de desarrollo.

No obstante, es importante reconocer las limitaciones inherentes a este enfoque en el contexto de este trabajo:

\begin{itemize}
    \item \textbf{Rendimiento no representativo:} El prototipo fue evaluado en un entorno de laboratorio controlado, por lo que su rendimiento no refleja las condiciones de una red pública con alta carga transaccional.
    
    \item \textbf{Gestión de expectativas:} Una versión funcional puede generar expectativas en los usuarios de que el sistema está casi terminado, cuando aún requiere fases críticas de seguridad y optimización.
    
    \item \textbf{Disciplina de desarrollo:} Se requirió una disciplina estricta para asegurar que el código del prototipo, concebido para validación, no se promoviera a un entorno de producción sin pasar por procesos formales de auditoría y refactorización.
\end{itemize}

En conclusión, la metodología por prototipos fue fundamental para navegar la complejidad e incertidumbre del proyecto. Permitió demostrar de manera empírica que una arquitectura descentralizada es una solución técnica viable y socialmente pertinente para fortalecer la confianza en la gestión de fotocomparendos en Bogotá. 
\subsection{Introducción a los artefactos técnicos del diseño}
Con el fin de estructurar de manera clara el desarrollo de la solución propuesta, en esta sección se presentan los principales artefactos utilizados durante la etapa de diseño. Estos elementos permiten representar gráficamente tanto la lógica de funcionamiento como la arquitectura del sistema, sirviendo como guía para la implementación y posterior validación del prototipo.

El conjunto de diagramas que se incluye responde a la necesidad de modelar distintos aspectos del sistema. Por un lado, se usan diagramas de casos de uso para identificar las funcionalidades clave desde la perspectiva del usuario. Por otro, los diagramas de clases permiten definir la estructura del software, mientras que los diagramas de despliegue muestran cómo se distribuyen los componentes en el entorno tecnológico. Además, se incluyen diagramas de flujo que describen el comportamiento del sistema ante eventos específicos, facilitando la comprensión de su dinámica interna.

Cada uno de estos artefactos está alineado con los objetivos del proyecto y fue elaborado considerando tanto las necesidades funcionales como las características propias de las tecnologías involucradas, en particular el uso de Blockchain e IPFS. De esta forma, se busca garantizar coherencia técnica en el diseño y establecer una base sólida para el desarrollo e implementación de la solución.
