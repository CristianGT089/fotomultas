\documentclass[
    letterpaper, 
    man,   
    spanish,
    12pt,
    floatsintext,
    hidelinks % Opción para hyperref pasada a la clase
]{apa7}

% --- Pasar opciones a paquetes antes de que la clase los cargue ---
\PassOptionsToPackage{table}{xcolor}

% --- Codificación y Lenguaje ---
\usepackage[utf8]{inputenc} 
\usepackage{newunicodechar}
\usepackage[spanish]{babel} 
\selectlanguage{spanish}   
\usepackage{csquotes}       

% --- Definición de caracteres Unicode problemáticos ---
\newunicodechar{́}{'}  % U+0301 COMBINING ACUTE ACCENT
\newunicodechar{—}{---}  % U+2014 EM DASH
\newunicodechar{ć}{c'}  % U+0107 LATIN SMALL LETTER C WITH ACUTE
\newunicodechar{ı}{i}  % U+0131 LATIN SMALL LETTER DOTLESS I
\newunicodechar{≤}{\ensuremath{\leq}}  % U+2264 LESS-THAN OR EQUAL TO
\usepackage{amssymb}  % Para símbolos como checkmark
\newunicodechar{✓}{\ensuremath{\checkmark}}  % U+2713 CHECK MARK
\newunicodechar{→}{\ensuremath{\rightarrow}}  % U+2192 RIGHTWARDS ARROW

% --- Bibliografía con biblatex-apa ---
\usepackage[
    style=apa,            
    backend=biber,        
    sortcites=true,       
    sorting=nyt,          
    hyperref=true,
    backref=false         
]{biblatex}
\DeclareLanguageMapping{spanish}{spanish-apa}
\addbibresource{bibliography.bib} 

% --- Paquetes para Gráficos y Tablas ---
\usepackage{graphicx}     
\usepackage{booktabs}     
\usepackage{adjustbox}    
\usepackage{multirow}     
\usepackage{array}
\usepackage{pifont}       % Para usar símbolos como \ding
% xcolor con opción table se carga via PassOptionsToPackage arriba
\usepackage{caption}
% Definir separador personalizado con espacio vertical entre número y título de tabla
\DeclareCaptionLabelSeparator{newlinewithspace}{\\[6pt]}
\usepackage{longtable}    % Tablas que se extienden por múltiples páginas
\usepackage{setspace}     % Para control de interlineado
\usepackage{ragged2e}     % Para alineación que mantiene sangría
% \captionsetup[figure]{labelformat=default,labelsep=period,name=Figura,position=above,labelfont=bf,textfont=it}
\captionsetup[table]{labelformat=default,labelsep=newlinewithspace,labelfont=bf,textfont=it,skip=10pt,name=Tabla}
% \usepackage{epstopdf}
\usepackage{float}
\usepackage{placeins}     % Para usar \FloatBarrier y evitar que tablas se corten
\usepackage{afterpage}    % Para controlar colocación de flotantes
\usepackage{eso-pic}      % Para posicionar número de página en portada

% Parámetros optimizados para evitar que tablas se corten al final de página
\renewcommand{\floatpagefraction}{0.5}       % Página necesita solo 50% de flotantes para dedicarse a ellos
\renewcommand{\topfraction}{0.95}            % Permite hasta 95% arriba
\renewcommand{\bottomfraction}{0.95}         % Permite hasta 95% abajo
\renewcommand{\textfraction}{0.05}           % Solo requiere 5% de texto
\setcounter{topnumber}{4}                    % Hasta 4 flotantes arriba
\setcounter{bottomnumber}{4}                 % Hasta 4 flotantes abajo
\setcounter{totalnumber}{8}                  % Hasta 8 flotantes por página
\setlength{\floatsep}{12pt plus 4pt minus 4pt}
\setlength{\textfloatsep}{20pt plus 8pt minus 4pt}
\setlength{\intextsep}{14pt plus 4pt minus 4pt}       

% --- COMANDOS PERSONALIZADOS
 \newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\} % Esto 
% --- Definición de comandos de tamaño de fuente ---
\renewcommand{\large}{\fontsize{14.4}{18}\selectfont}

% --- Información del Documento (Ejemplo) ---

\title{Prototipo para apoyar el registro y trazabilidad de estados en el proceso de fotocomparendos aplicando tecnologías de redes distribuidas}
\shorttitle{Gestión Descentralizada de Comparendos}
\author{Laura Catalina Preciado Ballen \\Cristian Stiven Guzman Tovar}
\affiliation{Universidad Distrital Francisco José de Caldas}
\course{Proyecto de grado para optar al título de: \\Ingeniero (a) de Sistemas}
\professor{Julio Baron Velandia, Ph.D}
\duedate{\today}
\abstract{Este trabajo propone el diseño e implementación de un prototipo basado en blockchain para la gestión de fotocomparendos en Bogotá, con el objetivo de garantizar la transparencia del proceso. Se utilizan contratos inteligentes para registrar cada infracción, permitiendo que cualquier actor autorizado pueda verificar su autenticidad sin necesidad de intermediarios. El prototipo, validado en entorno de laboratorio con datos sintéticos, demuestra mediante pruebas funcionales y de integridad cómo esta tecnología puede fortalecer la confianza en los procesos de control de tránsito y mejorar la eficiencia en la gestión de sanciones.}
\keywords{Fotocomparendos, Gestión de datos, Blockchain, Ingeniería web}

\begin{document}

% Configuración APA 7: Sangría y espaciado
\setlength{\parindent}{1.27cm} % 0.5 pulgadas de sangría en primera línea
\doublespacing % Doble espacio según APA 7
% \maketitle
\include{cover}

\raggedbottom

\pagenumbering{roman}
% Contenido
\renewcommand\contentsname{\textbf{Índice}}
\tableofcontents
\setcounter{tocdepth}{2}
\newpage
% Fíguras
\renewcommand{\listfigurename}{\textbf{Índice de figuras}}
\listoffigures
\newpage
% Tablas
\renewcommand{\listtablename}{\textbf{Índice de tablas}}
\listoftables
\newpage

% Cuerpo
\pagenumbering{arabic}
\setcounter{page}{2} % Continuar desde 2 (portada fue 1)

% Incluir capítulos modularizados
\include{chapters/01_introduccion}
\include{chapters/02_justificacion}
\include{chapters/03_marco_teorico}
\include{chapters/04_estado_arte}
\include{chapters/05_metodologia}
\include{chapters/06_alcance_limitaciones}
\include{chapters/07_diseno_prototipo}
\include{chapters/08_implementacion}
\include{chapters/09_plan_pruebas}
\include{chapters/10_resultados}
\include{chapters/11_discusion}
\include{chapters/12_conclusiones}
\include{chapters/13_anexos}

% Referencias
\newpage
\printbibliography[
	heading=bibintoc,
	title={Referencias}
]
\end{document}
